Development and validation of the random walk algorithm: application to the classification of diffuse heterogeneity in brain SPECT perfusion images. Heterogeneity analysis has been studied for radiological imaging, but few methods have been developed for functional images. Diffuse heterogeneous perfusion frequently appears in brain single photon emission computed tomography (SPECT) images, but objective quantification is lacking. An automatic method, based on random walk (RW) theory, has been developed to quantify perfusion heterogeneity. We assess the robustness of our algorithm in differentiating levels of diffuse heterogeneity even when focal defects are present.Heterogeneity is quantified by counting R (percentage), the mean rate of visited pixels in a fixed number of steps of the stochastic RW process. The algorithm has been tested on the numerical anthropomorphic Zubal head phantom. Seven diffuse cortical heterogeneity levels were simulated with an adjustable Gaussian function and 6 temporoparietal focal defects simulating Alzheimer Disease, leading to 42 phantoms. Data were projected and smoothed (full width at half maximum, 5.5 mm), and Poisson noise was added to the 64 projections. The SPECT data were reconstructed using filtered backprojection (Hamming filter, 0.5 c/p). R values for different levels of perfusion defect and diffuse heterogeneity were evaluated on 3 parameters: the number of slices studied (20 vs 40), the use of Talairach normalization versus original space, and the use of a cortical mask within the Talairach space. For each parameter, regression lines for heterogeneity and temporoparietal defect quantification were analyzed by covariance statistics. R values were also evaluated on SPECT images performed on 25 subjects with suspected focal dementia and on 15 normal controls. Scans were blindly ranked by 2 experienced nuclear physicians according to the degree of diffuse heterogeneity.Variability of R was smaller than 0.17% for repeated measurements. R was more particularly influenced by diffuse heterogeneity compared with focal perfusion defect. The Talairach normalization had a significant influence on the heterogeneity quantification. The number of slices visited by the RW and the cortical masking have a weak influence on the heterogeneity quantification but only for very low heterogeneity levels. The Spearman coefficient between physicians' consensus and RW automatic ranking is 0.85, in the same order of magnitude as the Spearman coefficient between the rankings of the 2 senior physicians (0.86).Random walk is an original and objective method and is able to quantify heterogeneous brain perfusion, even in presence of cortical defects. This method is repeatable, robust, and mainly influenced by spatial normalization.