Nonlinear motion correction of respiratory-gated lung SPECT images. We propose a method for correcting the motion of the lungs between different phase images obtained by respiratory-gated single photon emission computed tomography (SPECT). This method is applied to SPECT images that show a preserved activity distribution in the lungs such as 99m-Tc macro aggregated albumin (99m-Tc-MAA) perfusion images and 99m-Tc-Technegas ventilation images. In the proposed method, an objective function, which consists of both the degree of similarity between a reference image and a deformed image, and the smoothness of deformation is defined and optimized using a simulated annealing algorithm. For the degree of similarity term in the objective function, an expansion ratio, defined as the ratio of change in local volume due to deformation, is introduced to preserve the total activity during the motion correction process. This method was applied to data simulated from computer phantoms, data acquired from a physical phantom, and 17 sets of clinical data. In all cases, the motion correction between inspiration and expiration phase images was successfully achieved.